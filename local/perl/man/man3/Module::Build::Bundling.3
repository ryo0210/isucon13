.\" -*- mode: troff; coding: utf-8 -*-
.\" Automatically generated by Pod::Man 5.01 (Pod::Simple 3.43)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" \*(C` and \*(C' are quotes in nroff, nothing in troff, for use with C<>.
.ie n \{\
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds C`
.    ds C'
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is >0, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.\"
.\" Avoid warning from groff about undefined register 'F'.
.de IX
..
.nr rF 0
.if \n(.g .if rF .nr rF 1
.if (\n(rF:(\n(.g==0)) \{\
.    if \nF \{\
.        de IX
.        tm Index:\\$1\t\\n%\t"\\$2"
..
.        if !\nF==2 \{\
.            nr % 0
.            nr F 2
.        \}
.    \}
.\}
.rr rF
.\" ========================================================================
.\"
.IX Title "Module::Build::Bundling 3"
.TH Module::Build::Bundling 3 2024-10-23 "perl v5.38.0" "User Contributed Perl Documentation"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH NAME
Module::Build::Bundling \- How to bundle Module::Build with a distribution
.SH SYNOPSIS
.IX Header "SYNOPSIS"
.Vb 2
\&  # Build.PL
\&  use inc::latest \*(AqModule::Build\*(Aq;
\&
\&  Module::Build\->new(
\&    module_name => \*(AqFoo::Bar\*(Aq,
\&    license => \*(Aqperl\*(Aq,
\&  )\->create_build_script;
.Ve
.SH DESCRIPTION
.IX Header "DESCRIPTION"
\&\fBWARNING \-\- THIS IS AN EXPERIMENTAL FEATURE\fR
.PP
In order to install a distribution using Module::Build, users must
have Module::Build available on their systems.  There are two ways
to do this.  The first way is to include Module::Build in the
\&\f(CW\*(C`configure_requires\*(C'\fR metadata field.  This field is supported by
recent versions CPAN and CPANPLUS and is a standard feature
in the Perl core as of Perl 5.10.1.  Module::Build now adds itself
to \f(CW\*(C`configure_requires\*(C'\fR by default.
.PP
The second way supports older Perls that have not upgraded CPAN or
CPANPLUS and involves bundling an entire copy of Module::Build
into the distribution's \f(CW\*(C`inc/\*(C'\fR directory.  This is the same approach
used by Module::Install, a modern wrapper around ExtUtils::MakeMaker
for Makefile.PL based distributions.
.PP
The "trick" to making this work for Module::Build is making sure the
highest version Module::Build is used, whether this is in \f(CW\*(C`inc/\*(C'\fR or
already installed on the user's system.  This ensures that all necessary
features are available as well as any new bug fixes.  This is done using
the experimental inc::latest module, available on CPAN.
.PP
A "normal" Build.PL looks like this (with only the minimum required
fields):
.PP
.Vb 1
\&  use Module::Build;
\&
\&  Module::Build\->new(
\&    module_name => \*(AqFoo::Bar\*(Aq,
\&    license     => \*(Aqperl\*(Aq,
\&  )\->create_build_script;
.Ve
.PP
A "bundling" Build.PL replaces the initial "use" line with a nearly
transparent replacement:
.PP
.Vb 1
\&  use inc::latest \*(AqModule::Build\*(Aq;
\&
\&  Module::Build\->new(
\&    module_name => \*(AqFoo::Bar\*(Aq,
\&    license => \*(Aqperl\*(Aq,
\&  )\->create_build_script;
.Ve
.PP
For \fIauthors\fR, when "Build dist" is run, Module::Build will be
automatically bundled into \f(CW\*(C`inc\*(C'\fR according to the rules for
inc::latest.
.PP
For \fIusers\fR, inc::latest will load the latest Module::Build, whether
installed or bundled in \f(CW\*(C`inc/\*(C'\fR.
.SH "BUNDLING OTHER CONFIGURATION DEPENDENCIES"
.IX Header "BUNDLING OTHER CONFIGURATION DEPENDENCIES"
The same approach works for other configuration dependencies \-\- modules
that \fImust\fR be available for Build.PL to run.  All other dependencies can
be specified as usual in the Build.PL and CPAN or CPANPLUS will install
them after Build.PL finishes.
.PP
For example, to bundle the Devel::AssertOS::Unix module (which ensures a
"Unix-like" operating system), one could do this:
.PP
.Vb 2
\&  use inc::latest \*(AqDevel::AssertOS::Unix\*(Aq;
\&  use inc::latest \*(AqModule::Build\*(Aq;
\&
\&  Module::Build\->new(
\&    module_name => \*(AqFoo::Bar\*(Aq,
\&    license => \*(Aqperl\*(Aq,
\&  )\->create_build_script;
.Ve
.PP
The \f(CW\*(C`inc::latest\*(C'\fR module creates bundled directories based on the packlist
file of an installed distribution.  Even though \f(CW\*(C`inc::latest\*(C'\fR takes module
name arguments, it is better to think of it as bundling and making
available entire \fIdistributions\fR.  When a module is loaded through
\&\f(CW\*(C`inc::latest\*(C'\fR, it looks in all bundled distributions in \f(CW\*(C`inc/\*(C'\fR for a
newer module than can be found in the existing \f(CW@INC\fR array.
.PP
Thus, the module-name provided should usually be the "top-level" module
name of a distribution, though this is not strictly required.  For example,
Module::Build has a number of heuristics to map module names to
packlists, allowing users to do things like this:
.PP
.Vb 1
\&  use inc::latest \*(AqDevel::AssertOS::Unix\*(Aq;
.Ve
.PP
even though Devel::AssertOS::Unix is contained within the Devel-CheckOS
distribution.
.PP
At the current time, packlists are required.  Thus, bundling dual-core
modules, \fIincluding Module::Build\fR, may require a 'forced install' over
versions in the latest version of perl in order to create the necessary
packlist for bundling.  This limitation will hopefully be addressed in a
future version of Module::Build.
.SS "WARNING \-\- How to Manage Dependency Chains"
.IX Subsection "WARNING -- How to Manage Dependency Chains"
Before bundling a distribution you must ensure that all prerequisites are
also bundled and load in the correct order.  For Module::Build itself, this
should not be necessary, but it is necessary for any other distribution.
(A future release of Module::Build will hopefully address this deficiency.)
.PP
For example, if you need \f(CW\*(C`Wibble\*(C'\fR, but \f(CW\*(C`Wibble\*(C'\fR depends on \f(CW\*(C`Wobble\*(C'\fR,
your Build.PL might look like this:
.PP
.Vb 3
\&  use inc::latest \*(AqWobble\*(Aq;
\&  use inc::latest \*(AqWibble\*(Aq;
\&  use inc::latest \*(AqModule::Build\*(Aq;
\&
\&  Module::Build\->new(
\&    module_name => \*(AqFoo::Bar\*(Aq,
\&    license => \*(Aqperl\*(Aq,
\&  )\->create_build_script;
.Ve
.PP
Authors are strongly suggested to limit the bundling of additional
dependencies if at all possible and to carefully test their distribution
tarballs on older versions of Perl before uploading to CPAN.
.SH AUTHOR
.IX Header "AUTHOR"
David Golden <dagolden@cpan.org>
.PP
Development questions, bug reports, and patches should be sent to the
Module-Build mailing list at <module\-build@perl.org>.
.PP
Bug reports are also welcome at
<http://rt.cpan.org/NoAuth/Bugs.html?Dist=Module\-Build>.
.SH "SEE ALSO"
.IX Header "SEE ALSO"
\&\fBperl\fR\|(1), inc::latest, Module::Build(3), Module::Build::API(3),
Module::Build::Cookbook(3),
